# Rubber Tracker - Data Flow Diagram

> This document provides a visual representation of how data flows between sheets in the Rubber Tracker system.

---

## Table of Contents
1. [System Overview](#system-overview)
2. [Master Data Sources](#master-data-sources)
3. [Generated Reports Flow](#generated-reports-flow)
4. [Swap Workflow Data Flow](#swap-workflow-data-flow)
5. [Employee Lifecycle Flow](#employee-lifecycle-flow)
6. [Reclaims Data Flow](#reclaims-data-flow)
7. [Complete System Flowchart](#complete-system-flowchart)

---

## System Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         RUBBER TRACKER SYSTEM                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│   │    GLOVES       │    │    SLEEVES      │    │   EMPLOYEES     │        │
│   │   (Inventory)   │    │   (Inventory)   │    │  (Master List)  │        │
│   └────────┬────────┘    └────────┬────────┘    └────────┬────────┘        │
│            │                      │                      │                  │
│            └──────────────┬───────┴──────────────────────┘                  │
│                           │                                                 │
│                           ▼                                                 │
│            ┌──────────────────────────────┐                                 │
│            │    REPORT GENERATION         │                                 │
│            │  (Generate All Reports)      │                                 │
│            └──────────────┬───────────────┘                                 │
│                           │                                                 │
│       ┌───────────────────┼───────────────────┬─────────────────┐          │
│       ▼                   ▼                   ▼                 ▼          │
│ ┌───────────┐     ┌───────────────┐    ┌───────────┐    ┌───────────┐      │
│ │  GLOVE    │     │    SLEEVE     │    │ RECLAIMS  │    │  TO-DO    │      │
│ │  SWAPS    │     │    SWAPS      │    │           │    │   LIST    │      │
│ └───────────┘     └───────────────┘    └───────────┘    └───────────┘      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Master Data Sources

### Primary Data Sheets (Source of Truth)

```
┌────────────────────────────────────────────────────────────────────────────┐
│                        MASTER DATA SHEETS                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                         GLOVES SHEET                                │  │
│  │  ┌────────┬──────┬───────┬───────────┬──────────────┬────────────┐ │  │
│  │  │ Item # │ Size │ Class │ Test Date │ Date Assigned│  Location  │ │  │
│  │  ├────────┼──────┼───────┼───────────┼──────────────┼────────────┤ │  │
│  │  │ Status │Assign│Change │ Picked For│    Notes     │            │ │  │
│  │  │        │ To   │Out Dt │            │              │            │ │  │
│  │  └────────┴──────┴───────┴───────────┴──────────────┴────────────┘ │  │
│  │                              │                                      │  │
│  │                              ▼                                      │  │
│  │         Provides: Item availability, current assignments,          │  │
│  │                   reservation status (Picked For)                  │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                        SLEEVES SHEET                                │  │
│  │  (Same structure as Gloves - Classes 2 & 3 only)                   │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                       EMPLOYEES SHEET                               │  │
│  │  ┌──────┬───────┬──────────┬────────────┬────────────┬───────────┐ │  │
│  │  │ Name │ Class │ Location │ Job Number │ Glove Size │Sleeve Size│ │  │
│  │  ├──────┼───────┼──────────┼────────────┼────────────┼───────────┤ │  │
│  │  │ Hire │ Last  │ Last Day │   Email    │   Phone    │           │ │  │
│  │  │ Date │ Day   │ Reason   │            │            │           │ │  │
│  │  └──────┴───────┴──────────┴────────────┴────────────┴───────────┘ │  │
│  │                              │                                      │  │
│  │                              ▼                                      │  │
│  │         Provides: Employee locations, preferred sizes,             │  │
│  │                   approved class levels, termination status        │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Generated Reports Flow

```
┌────────────────────────────────────────────────────────────────────────────┐
│                    REPORT GENERATION PROCESS                               │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                   INPUT: Generate All Reports                        │ │
│  └──────────────────────────────────┬───────────────────────────────────┘ │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                       STEP 1: READ INVENTORY                         │ │
│  │                                                                      │ │
│  │   ┌────────────┐          ┌────────────┐          ┌──────────────┐  │ │
│  │   │   GLOVES   │─────────▶│  Collect   │◀─────────│   SLEEVES    │  │ │
│  │   │   Sheet    │          │  All Items │          │    Sheet     │  │ │
│  │   └────────────┘          │  by Class  │          └──────────────┘  │ │
│  │                           └─────┬──────┘                             │ │
│  │                                 │                                    │ │
│  │                                 ▼                                    │ │
│  │   Filter by: Status (On Shelf, In Testing, Ready For Delivery)      │ │
│  │              + Reserved items (Picked For column)                   │ │
│  └──────────────────────────────────┬───────────────────────────────────┘ │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                    STEP 2: READ EMPLOYEE DATA                        │ │
│  │                                                                      │ │
│  │   ┌────────────┐          ┌──────────────────────────────────────┐  │ │
│  │   │ EMPLOYEES  │─────────▶│  Build lookup maps for:              │  │ │
│  │   │   Sheet    │          │  • Name → Location                   │  │ │
│  │   └────────────┘          │  • Name → Glove Size                 │  │ │
│  │                           │  • Name → Sleeve Size                │  │ │
│  │                           │  • Name → Approved Class             │  │ │
│  │                           └──────────────────────────────────────┘  │ │
│  └──────────────────────────────────┬───────────────────────────────────┘ │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                  STEP 3: IDENTIFY ITEMS DUE FOR SWAP                 │ │
│  │                                                                      │ │
│  │   For each item in Gloves/Sleeves where Status = "Assigned":        │ │
│  │   ┌─────────────────────────────────────────────────────────────┐   │ │
│  │   │  IF Change Out Date ≤ Today + 31 days                       │   │ │
│  │   │     → Add employee to swap list                             │   │ │
│  │   │     → Calculate Days Left (or "OVERDUE")                    │   │ │
│  │   └─────────────────────────────────────────────────────────────┘   │ │
│  └──────────────────────────────────┬───────────────────────────────────┘ │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                    STEP 4: RUN PICK LIST MATCHING                    │ │
│  │                                                                      │ │
│  │   For each employee needing swap:                                    │ │
│  │   ┌─────────────────────────────────────────────────────────────┐   │ │
│  │   │  1. Check for existing "Picked For" reservation             │   │ │
│  │   │     └─ If found → Use reserved item, set Picked = TRUE      │   │ │
│  │   │                                                             │   │ │
│  │   │  2. If no reservation, search inventory:                    │   │ │
│  │   │     └─ Priority: Exact Size On Shelf                        │   │ │
│  │   │     └─ Priority: Size Up (+0.5) On Shelf                    │   │ │
│  │   │     └─ Priority: Exact Size In Testing/Ready                │   │ │
│  │   │     └─ Priority: Size Up In Testing/Ready                   │   │ │
│  │   │     └─ If none found → "Need to Purchase ❌"                │   │ │
│  │   └─────────────────────────────────────────────────────────────┘   │ │
│  └──────────────────────────────────┬───────────────────────────────────┘ │
│                                     │                                      │
│              ┌──────────────────────┼──────────────────────┐              │
│              ▼                      ▼                      ▼              │
│  ┌────────────────┐    ┌────────────────────┐    ┌────────────────┐      │
│  │  GLOVE SWAPS   │    │   SLEEVE SWAPS     │    │   RECLAIMS     │      │
│  │    Sheet       │    │      Sheet         │    │    Sheet       │      │
│  └────────────────┘    └────────────────────┘    └────────────────┘      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Swap Workflow Data Flow

```
┌────────────────────────────────────────────────────────────────────────────┐
│                       SWAP WORKFLOW STAGES                                 │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ╔════════════════════════════════════════════════════════════════════╗   │
│  ║  STAGE 1: SWAP GENERATED                                           ║   │
│  ╠════════════════════════════════════════════════════════════════════╣   │
│  ║                                                                    ║   │
│  ║   ┌────────────┐     Generate     ┌─────────────────────────────┐ ║   │
│  ║   │ Gloves/    │ ───────────────▶ │     SWAP SHEET              │ ║   │
│  ║   │ Sleeves    │                  │ • Employee Name             │ ║   │
│  ║   │ Sheet      │                  │ • Current Item #            │ ║   │
│  ║   └────────────┘                  │ • Pick List Item #          │ ║   │
│  ║         │                         │ • Status (In Stock ✅)      │ ║   │
│  ║         │                         │ • Picked = FALSE            │ ║   │
│  ║         ▼                         │ • Date Changed = empty      │ ║   │
│  ║   Stores in hidden cols:          └─────────────────────────────┘ ║   │
│  ║   K-M: Pick List item original state                              ║   │
│  ║   N-P: Current item assignment info                               ║   │
│  ║                                                                    ║   │
│  ╚════════════════════════════════════════════════════════════════════╝   │
│                                     │                                      │
│                                     │ User checks "Picked" checkbox        │
│                                     ▼                                      │
│  ╔════════════════════════════════════════════════════════════════════╗   │
│  ║  STAGE 2: ITEM PICKED                                              ║   │
│  ╠════════════════════════════════════════════════════════════════════╣   │
│  ║                                                                    ║   │
│  ║   ┌─────────────────────────────┐      ┌────────────────────────┐ ║   │
│  ║   │        SWAP SHEET           │      │    INVENTORY SHEET     │ ║   │
│  ║   │  Picked = TRUE ✓            │      │    (Pick List Item)    │ ║   │
│  ║   │  Status = Ready For         │─────▶│                        │ ║   │
│  ║   │          Delivery 🚚        │      │ Status → Ready For     │ ║   │
│  ║   └─────────────────────────────┘      │          Delivery      │ ║   │
│  ║                                        │ Assigned → Packed For  │ ║   │
│  ║   Stage 2 data stored in:              │            Delivery    │ ║   │
│  ║   Cols Q-T                             │ Location → Cody's Truck│ ║   │
│  ║                                        │ Picked For → "Employee │ ║   │
│  ║                                        │   Picked On YYYY-MM-DD"│ ║   │
│  ║                                        └────────────────────────┘ ║   │
│  ╚════════════════════════════════════════════════════════════════════╝   │
│                                     │                                      │
│                                     │ User enters Date Changed             │
│                                     ▼                                      │
│  ╔════════════════════════════════════════════════════════════════════╗   │
│  ║  STAGE 3: SWAP COMPLETED                                           ║   │
│  ╠════════════════════════════════════════════════════════════════════╣   │
│  ║                                                                    ║   │
│  ║   ┌─────────────────────────────┐                                 ║   │
│  ║   │        SWAP SHEET           │                                 ║   │
│  ║   │  Date Changed = MM/DD/YYYY  │                                 ║   │
│  ║   │  Status = Assigned          │                                 ║   │
│  ║   │  Days Left = "Assigned"     │                                 ║   │
│  ║   └──────────────┬──────────────┘                                 ║   │
│  ║                  │                                                 ║   │
│  ║          ┌───────┴───────┐                                         ║   │
│  ║          ▼               ▼                                         ║   │
│  ║   ┌─────────────┐  ┌─────────────────────────────────────────┐    ║   │
│  ║   │ NEW ITEM    │  │          OLD ITEM                       │    ║   │
│  ║   │ (Pick List) │  │        (Employee's Current)             │    ║   │
│  ║   ├─────────────┤  ├─────────────────────────────────────────┤    ║   │
│  ║   │Status:      │  │Status: Ready For Test                   │    ║   │
│  ║   │ Assigned    │  │Assigned To: Packed For Testing          │    ║   │
│  ║   │Assigned To: │  │Location: Cody's Truck                   │    ║   │
│  ║   │ Employee    │  │                                         │    ║   │
│  ║   │Location:    │  │→ Goes back for electrical testing       │    ║   │
│  ║   │ Emp's loc   │  └─────────────────────────────────────────┘    ║   │
│  ║   │Picked For:  │                                                 ║   │
│  ║   │ Cleared     │                                                 ║   │
│  ║   └─────────────┘                                                 ║   │
│  ║                                                                    ║   │
│  ║   Stage 3 data stored in: Cols U-W                                ║   │
│  ║                                                                    ║   │
│  ╚════════════════════════════════════════════════════════════════════╝   │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### Revert Flow (Undo Operations)

```
┌────────────────────────────────────────────────────────────────────────────┐
│                          REVERT OPERATIONS                                 │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │  STAGE 4: REVERT (Clear Date Changed)                                │ │
│  │  ─────────────────────────────────────                               │ │
│  │                                                                      │ │
│  │  User clears Date Changed value:                                     │ │
│  │  ┌──────────────────────────────────────────────────────────────┐   │ │
│  │  │  • NEW ITEM → Reverts to Stage 2 (Ready For Delivery)        │   │ │
│  │  │  • OLD ITEM → Reverts to Stage 1 (Assigned to Employee)      │   │ │
│  │  │  • Stage 3 columns (U-W) → Cleared                           │   │ │
│  │  └──────────────────────────────────────────────────────────────┘   │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │  STAGE 5: UNPICK (Uncheck Picked Checkbox)                           │ │
│  │  ─────────────────────────────────────────                           │ │
│  │                                                                      │ │
│  │  User unchecks Picked checkbox:                                      │ │
│  │  ┌──────────────────────────────────────────────────────────────┐   │ │
│  │  │  • Pick List Item → Reverts to Stage 1 (On Shelf)            │   │ │
│  │  │  • Stage 2 columns (Q-T) → Cleared                           │   │ │
│  │  │  • Stage 3 columns (U-W) → Cleared (if set)                  │   │ │
│  │  │  • Date Changed → Cleared                                    │   │ │
│  │  │  • Picked For column → Cleared                               │   │ │
│  │  └──────────────────────────────────────────────────────────────┘   │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Employee Lifecycle Flow

```
┌────────────────────────────────────────────────────────────────────────────┐
│                      EMPLOYEE LIFECYCLE DATA FLOW                          │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│                       ┌─────────────────────────────┐                      │
│                       │      NEW EMPLOYEE           │                      │
│                       │   Added to Employees        │                      │
│                       │   Sheet                     │                      │
│                       └─────────────┬───────────────┘                      │
│                                     │                                      │
│              ┌──────────────────────┼──────────────────────┐              │
│              ▼                      ▼                      ▼              │
│  ┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐  │
│  │   GLOVES SHEET     │  │   SLEEVES SHEET    │  │  EMPLOYEE HISTORY  │  │
│  │ Uses for:          │  │ Uses for:          │  │ Creates:           │  │
│  │ • Location lookup  │  │ • Location lookup  │  │ • "Current State"  │  │
│  │ • Size matching    │  │ • Size matching    │  │   entry on first   │  │
│  │ • Class approval   │  │ • Class approval   │  │   change tracked   │  │
│  └────────────────────┘  └────────────────────┘  └────────────────────┘  │
│                                                                            │
│  ═══════════════════════════════════════════════════════════════════════  │
│                                                                            │
│                       ┌─────────────────────────────┐                      │
│                       │  EMPLOYEE DATA CHANGED      │                      │
│                       │  (Location or Job Number)   │                      │
│                       └─────────────┬───────────────┘                      │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                     AUTOMATIC TRACKING                               │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │  1. If no history exists → Create "Current State" entry        │ │ │
│  │  │  2. Create change entry:                                       │ │ │
│  │  │     • "Location Change"                                        │ │ │
│  │  │     • "Job Number Change"                                      │ │ │
│  │  │     • "Location & Job # Change"                                │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                              │                                       │ │
│  │                              ▼                                       │ │
│  │                    ┌─────────────────────┐                          │ │
│  │                    │  EMPLOYEE HISTORY   │                          │ │
│  │                    │  New row added      │                          │ │
│  │                    └─────────────────────┘                          │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│  ═══════════════════════════════════════════════════════════════════════  │
│                                                                            │
│                       ┌─────────────────────────────┐                      │
│                       │   EMPLOYEE TERMINATED       │                      │
│                       │   (Last Day filled in)      │                      │
│                       └─────────────┬───────────────┘                      │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                      TERMINATION PROCESS                             │ │
│  │                                                                      │ │
│  │   ┌─────────────────┐                                               │ │
│  │   │ EMPLOYEES SHEET │                                               │ │
│  │   │ Last Day filled │                                               │ │
│  │   └────────┬────────┘                                               │ │
│  │            │                                                         │ │
│  │            ▼                                                         │ │
│  │   ┌────────────────────────────────────────────────────────────┐    │ │
│  │   │  handleLastDayChange() trigger fires:                      │    │ │
│  │   │  1. Creates "Terminated" entry in Employee History         │    │ │
│  │   │  2. Location → "Previous Employee"                         │    │ │
│  │   │  3. Row REMOVED from Employees sheet                       │    │ │
│  │   └────────────────────────────────────────────────────────────┘    │ │
│  │            │                                                         │ │
│  │            ▼                                                         │ │
│  │   ┌─────────────────┐    ┌─────────────────────────────────────┐    │ │
│  │   │EMPLOYEE HISTORY │    │         RECLAIMS SHEET              │    │ │
│  │   │ "Terminated"    │    │  "Previous Employee Reclaims"       │    │ │
│  │   │  entry added    │    │   table updated (next report gen)   │    │ │
│  │   └─────────────────┘    └─────────────────────────────────────┘    │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│  ═══════════════════════════════════════════════════════════════════════  │
│                                                                            │
│                       ┌─────────────────────────────┐                      │
│                       │    EMPLOYEE REHIRED         │                      │
│                       │  (Rehire Date filled in     │                      │
│                       │   on Employee History)      │                      │
│                       └─────────────┬───────────────┘                      │
│                                     │                                      │
│                                     ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                        REHIRE PROCESS                                │ │
│  │                                                                      │ │
│  │   ┌──────────────────┐                                              │ │
│  │   │ EMPLOYEE HISTORY │                                              │ │
│  │   │ Rehire Date set  │                                              │ │
│  │   └────────┬─────────┘                                              │ │
│  │            │                                                         │ │
│  │            ▼                                                         │ │
│  │   ┌────────────────────────────────────────────────────────────┐    │ │
│  │   │  handleRehireDateChange() trigger fires:                   │    │ │
│  │   │  1. Prompts for new Location                               │    │ │
│  │   │  2. Prompts for new Job Number                             │    │ │
│  │   │  3. Creates NEW row in Employees sheet                     │    │ │
│  │   │     (Hire Date = Rehire Date)                              │    │ │
│  │   │  4. Creates "Rehired" entry in Employee History            │    │ │
│  │   └────────────────────────────────────────────────────────────┘    │ │
│  │            │                                                         │ │
│  │            ▼                                                         │ │
│  │   ┌─────────────────┐    ┌─────────────────┐                        │ │
│  │   │ EMPLOYEES SHEET │    │EMPLOYEE HISTORY │                        │ │
│  │   │ New row added   │    │ "Rehired" entry │                        │ │
│  │   └─────────────────┘    │  added          │                        │ │
│  │                          └─────────────────┘                        │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Reclaims Data Flow

```
┌────────────────────────────────────────────────────────────────────────────┐
│                         RECLAIMS DATA FLOW                                 │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                       INPUT SOURCES                                   │ │
│  │                                                                      │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌──────────────────────────────┐│ │
│  │   │   GLOVES    │  │   SLEEVES   │  │    APPROVED CLASS 3          ││ │
│  │   │   Sheet     │  │   Sheet     │  │    LOCATIONS TABLE           ││ │
│  │   │             │  │             │  │    (on Reclaims sheet)       ││ │
│  │   │ • Class     │  │ • Class     │  │                              ││ │
│  │   │ • Location  │  │ • Location  │  │  Helena    → CL2 & CL3       ││ │
│  │   │ • Assigned  │  │ • Assigned  │  │  Butte     → CL2 & CL3       ││ │
│  │   │   To        │  │   To        │  │  Bozeman   → CL2             ││ │
│  │   │ • Notes     │  │ • Notes     │  │  ...                         ││ │
│  │   └──────┬──────┘  └──────┬──────┘  └──────────────┬───────────────┘│ │
│  │          │                │                        │                │ │
│  │          └────────────────┼────────────────────────┘                │ │
│  │                           │                                          │ │
│  │                           ▼                                          │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                              │                                             │
│                              │ Update Reclaims Sheet                       │
│                              ▼                                             │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                    RECLAIM TYPE DETERMINATION                        │ │
│  │                                                                      │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │  FOR EACH ASSIGNED ITEM:                                       │ │ │
│  │  │                                                                │ │ │
│  │  │  1. Get employee's location from Employees sheet               │ │ │
│  │  │  2. Check Approved Class 3 Locations table                     │ │ │
│  │  │  3. Compare item class vs. location approval                   │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                           │                                          │ │
│  │       ┌───────────────────┼───────────────────┐                     │ │
│  │       ▼                   ▼                   ▼                     │ │
│  │  ┌──────────────┐  ┌──────────────────┐  ┌────────────────────┐    │ │
│  │  │ CLASS 3      │  │  CLASS 2         │  │  PREVIOUS EMP      │    │ │
│  │  │ RECLAIMS     │  │  RECLAIMS        │  │  RECLAIMS          │    │ │
│  │  │              │  │                  │  │                    │    │ │
│  │  │ Employee has │  │ Employee has     │  │ Items assigned to  │    │ │
│  │  │ CL3 item in  │  │ CL2 item in      │  │ terminated         │    │ │
│  │  │ location NOT │  │ CL3-ONLY         │  │ employees          │    │ │
│  │  │ approved for │  │ location         │  │                    │    │ │
│  │  │ CL3          │  │                  │  │                    │    │ │
│  │  │              │  │                  │  │                    │    │ │
│  │  │ ACTION:      │  │ ACTION:          │  │ ACTION:            │    │ │
│  │  │ DOWNGRADE    │  │ UPGRADE          │  │ Collect items      │    │ │
│  │  │ to CL2       │  │ to CL3           │  │                    │    │ │
│  │  └──────────────┘  └──────────────────┘  └────────────────────┘    │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                              │                                             │
│                              ▼                                             │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                   RECLAIMS AUTO PICK LIST                            │ │
│  │                   (Runs AFTER swap pick lists)                       │ │
│  │                                                                      │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │  1. Collect all items reserved by Swaps (Picked For)           │ │ │
│  │  │  2. For each reclaim:                                          │ │ │
│  │  │     a. Check if employee already has target class              │ │ │
│  │  │        → If yes: "Reclaim Only - Has CL2/CL3 ✅"               │ │ │
│  │  │     b. Search for replacement (same logic as swaps)            │ │ │
│  │  │        → In Stock ✅, Size Up ⚠️, Need to Purchase ❌          │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                              │                                             │
│                              ▼                                             │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                    LOST ITEMS INTEGRATION                            │ │
│  │                                                                      │ │
│  │   ┌─────────────────┐     ┌────────────────────────────────────┐    │ │
│  │   │ GLOVES/SLEEVES  │     │  🔍 LOST ITEMS - NEED TO LOCATE    │    │ │
│  │   │ where Notes     │────▶│     (Table on Reclaims Sheet)      │    │ │
│  │   │ contains        │     │                                    │    │ │
│  │   │ "LOST-LOCATE"   │     │  • Item Type                       │    │ │
│  │   └─────────────────┘     │  • Item #                          │    │ │
│  │                           │  • Last Location                   │    │ │
│  │                           │  • Last Assigned To                │    │ │
│  │                           └────────────────────────────────────┘    │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Complete System Flowchart

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                           COMPLETE SYSTEM DATA FLOW                                     │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                         │
│                         ╔═══════════════════════════════════════╗                       │
│                         ║        MASTER DATA SHEETS             ║                       │
│                         ║         (Source of Truth)             ║                       │
│                         ╚═══════════════════════════════════════╝                       │
│                                         │                                               │
│         ┌───────────────────────────────┼───────────────────────────────┐              │
│         │                               │                               │              │
│         ▼                               ▼                               ▼              │
│  ┌─────────────┐                 ┌─────────────┐                 ┌─────────────┐       │
│  │   GLOVES    │                 │  EMPLOYEES  │                 │   SLEEVES   │       │
│  │   SHEET     │                 │   SHEET     │                 │   SHEET     │       │
│  │             │                 │             │                 │             │       │
│  │ • Item #    │                 │ • Name      │                 │ • Item #    │       │
│  │ • Size      │◀───Location────▶│ • Location  │◀───Location────▶│ • Size      │       │
│  │ • Class     │    Lookup       │ • Class     │    Lookup       │ • Class     │       │
│  │ • Status    │                 │ • Sizes     │                 │ • Status    │       │
│  │ • Assigned  │                 │ • Hire/Term │                 │ • Assigned  │       │
│  │ • Picked For│◀───Reserved────▶│             │◀───Reserved────▶│ • Picked For│       │
│  └──────┬──────┘    Items        └──────┬──────┘    Items        └──────┬──────┘       │
│         │                               │                               │              │
│         │     ┌─────────────────────────┼─────────────────────────┐     │              │
│         │     │                         │                         │     │              │
│         │     │                         ▼                         │     │              │
│         │     │                ┌─────────────────┐                │     │              │
│         │     │                │    EMPLOYEE     │                │     │              │
│         │     │                │    HISTORY      │                │     │              │
│         │     │                │                 │                │     │              │
│         │     │                │ • Current State │                │     │              │
│         │     │                │ • Changes       │                │     │              │
│         │     │                │ • Terminated    │                │     │              │
│         │     │                │ • Rehired       │                │     │              │
│         │     │                └─────────────────┘                │     │              │
│         │     │                                                   │     │              │
│         └─────┼───────────────────────┬───────────────────────────┼─────┘              │
│               │                       │                           │                    │
│               │     ╔═════════════════╧═════════════════╗         │                    │
│               │     ║    REPORT GENERATION ENGINE       ║         │                    │
│               │     ║      (Generate All Reports)       ║         │                    │
│               │     ╚═════════════════╤═════════════════╝         │                    │
│               │                       │                           │                    │
│               │       ┌───────────────┼───────────────┬───────────┼────────┐          │
│               │       │               │               │           │        │          │
│               │       ▼               ▼               ▼           │        ▼          │
│               │ ┌───────────┐  ┌───────────┐  ┌───────────┐  │  ┌───────────┐        │
│               │ │  GLOVE    │  │  SLEEVE   │  │ RECLAIMS  │  │  │  TO-DO    │        │
│               │ │  SWAPS    │  │  SWAPS    │  │  SHEET    │  │  │  LIST     │        │
│               │ └─────┬─────┘  └─────┬─────┘  └─────┬─────┘  │  └─────┬─────┘        │
│               │       │              │              │         │        │              │
│               │       │              │              │         │        │              │
│               │       └──────────────┼──────────────┘         │        │              │
│               │                      │                        │        │              │
│               │                      ▼                        │        │              │
│               │            ┌───────────────────┐              │        │              │
│               │            │  PURCHASE NEEDS   │              │        │              │
│               │            │     SHEET         │◀─────────────┘        │              │
│               │            │                   │                       │              │
│               │            │ • Items to Order  │                       │              │
│               │            │ • Low Stock       │                       │              │
│               │            │ • Size Up Details │                       │              │
│               │            └───────────────────┘                       │              │
│               │                                                        │              │
│               │                      ┌─────────────────────────────────┘              │
│               │                      │                                                │
│               │                      ▼                                                │
│               │            ┌───────────────────────────────────────┐                  │
│               │            │           TO-DO LIST                  │                  │
│               │            │     (Consolidated Action List)        │                  │
│               │            │                                       │                  │
│               │            │  Pulls from:                          │                  │
│               │            │  • Glove Swaps (pending)              │                  │
│               │            │  • Sleeve Swaps (pending)             │                  │
│               │            │  • Reclaims (all)                     │                  │
│               │            │                                       │                  │
│               │            │  Groups by: Location                  │                  │
│               │            │  Sorts by: Priority                   │                  │
│               │            └───────────────────────────────────────┘                  │
│               │                                                                       │
│               │                                                                       │
│  ═════════════╧═══════════════════════════════════════════════════════════════════   │
│                                                                                       │
│                              USER ACTIONS & TRIGGERS                                  │
│                                                                                       │
│  ┌──────────────────────────────────────────────────────────────────────────────┐    │
│  │                                                                              │    │
│  │   ┌──────────────┐     ┌──────────────┐     ┌──────────────┐                │    │
│  │   │ Edit Gloves/ │     │ Check Picked │     │ Enter Date   │                │    │
│  │   │ Sleeves      │     │ Checkbox     │     │ Changed      │                │    │
│  │   └──────┬───────┘     └──────┬───────┘     └──────┬───────┘                │    │
│  │          │                    │                    │                        │    │
│  │          ▼                    ▼                    ▼                        │    │
│  │   ┌──────────────┐     ┌──────────────┐     ┌──────────────┐                │    │
│  │   │ onEdit       │     │ Stage 2      │     │ Stage 3      │                │    │
│  │   │ Trigger      │     │ Processing   │     │ Processing   │                │    │
│  │   │              │     │              │     │              │                │    │
│  │   │ • Status     │     │ • Update     │     │ • Assign new │                │    │
│  │   │ • Location   │     │   inventory  │     │   item       │                │    │
│  │   │ • Change Out │     │ • Set        │     │ • Return old │                │    │
│  │   │   Date       │     │   Picked For │     │   for testing│                │    │
│  │   └──────────────┘     └──────────────┘     └──────────────┘                │    │
│  │                                                                              │    │
│  └──────────────────────────────────────────────────────────────────────────────┘    │
│                                                                                       │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Data Relationships Summary

| From Sheet | To Sheet | Relationship | Data Flow |
|------------|----------|--------------|-----------|
| **Employees** | Gloves/Sleeves | One-to-Many | Location, Size lookup when assigning items |
| **Employees** | Employee History | One-to-Many | All changes/terminations logged |
| **Employees** | Swaps | One-to-Many | Determines who needs swaps |
| **Gloves** | Glove Swaps | One-to-One | Each swap references one current and one pick list item |
| **Sleeves** | Sleeve Swaps | One-to-One | Each swap references one current and one pick list item |
| **Gloves/Sleeves** | Reclaims | One-to-Many | Items needing class changes |
| **Swaps** | Gloves/Sleeves | Updates | Stage 2/3 write back to inventory |
| **Swaps + Reclaims** | To-Do List | Consolidation | All pending tasks combined |
| **Swaps + Reclaims** | Purchase Needs | Aggregation | "Need to Purchase" items summarized |

---

## Key Data Integrity Points

1. **Picked For** column in Gloves/Sleeves is the source of truth for reserved items
2. **Employee History** is append-only (never deleted) for complete audit trail
3. **Swap hidden columns** (K-W) store stage data for revert capability
4. **Manual picks** are identified by light blue background and preserved during regeneration
5. **Change Out Dates** are auto-calculated but can be fixed with utilities if triggers miss

---

*Last Updated: January 7, 2026*

